PROJECT: DATA TRANSFORMER (SQL)
===============================

TABLES
------

1) CUSTOMERS
------------
CustomerID | FirstName | LastName | Email | RegistrationDate

CREATE TABLE customers (
  CustomerID INT,
  FirstName VARCHAR(20),
  LastName VARCHAR(20),
  Email VARCHAR(50),
  RegistrationDate DATE
);

INSERT INTO customers VALUES
(1,'John','Doe','  john.doe@email.com  ','2022-03-15'),
(2,'Jane','Smith','jane.smith@email.com','2021-11-02');


2) ORDERS
---------
OrderID | CustomerID | OrderDate | TotalAmount

CREATE TABLE orders (
  OrderID INT,
  CustomerID INT,
  OrderDate DATE,
  TotalAmount DECIMAL(10,2)
);

INSERT INTO orders VALUES
(101,1,'2023-07-01',150.50),
(102,2,'2023-07-03',200.75);


3) EMPLOYEES
------------


CREATE TABLE employees (
  EmployeeID INT,
  FirstName VARCHAR(20),
  LastName VARCHAR(20),
  Department VARCHAR(20),
  HireDate DATE,
  Salary DECIMAL(10,2)
);

INSERT INTO employees VALUES
(1,'Mark','Johnson','Sales','2020-01-15',50000),
(2,'Susan','Lee','HR','2021-03-20',55000);


QUERIES
-------

1) 
SELECT o.OrderID, c.FirstName, c.LastName, o.TotalAmount
FROM orders o
INNER JOIN customers c
ON o.CustomerID = c.CustomerID;


2) 
SELECT c.FirstName, o.OrderID
FROM customers c
LEFT JOIN orders o
ON c.CustomerID = o.CustomerID;


3) 
SELECT c.FirstName, o.OrderID
FROM customers c
RIGHT JOIN orders o
ON c.CustomerID = o.CustomerID;


4)
SELECT c.FirstName, o.OrderID
FROM customers c
LEFT JOIN orders o ON c.CustomerID=o.CustomerID
UNION
SELECT c.FirstName, o.OrderID
FROM customers c
RIGHT JOIN orders o ON c.CustomerID=o.CustomerID;


5) 
SELECT FirstName, LastName
FROM customers
WHERE CustomerID IN (
  SELECT CustomerID
  FROM orders
  WHERE TotalAmount > (SELECT AVG(TotalAmount) FROM orders)
);


6) 
SELECT FirstName, Salary
FROM employees
WHERE Salary > (SELECT AVG(Salary) FROM employees);


7) 
SELECT OrderID,
YEAR(OrderDate) AS OrderYear,
MONTH(OrderDate) AS OrderMonth
FROM orders;


8) 
SELECT OrderID,
DATEDIFF(CURDATE(), OrderDate) AS DaysDifference
FROM orders;


9) 
SELECT DATE_FORMAT(OrderDate,'%d-%b-%Y') AS FormattedDate
FROM orders;


10) 
SELECT CONCAT(FirstName,' ',LastName) AS FullName
FROM customers;


11) 
SELECT REPLACE(FirstName,'John','Jonathan')
FROM customers;


12) 
SELECT UPPER(FirstName), LOWER(LastName)
FROM customers;


13) 
SELECT TRIM(Email)
FROM customers;


14) 
SELECT OrderID, TotalAmount,
SUM(TotalAmount) OVER (ORDER BY OrderDate) AS RunningTotal
FROM orders;


15) 
SELECT OrderID, TotalAmount,
RANK() OVER (ORDER BY TotalAmount DESC) AS RankNo
FROM orders;


16) 
SELECT OrderID, TotalAmount,
CASE
  WHEN TotalAmount > 1000 THEN '10% OFF'
  WHEN TotalAmount > 500 THEN '5% OFF'
  ELSE 'No Discount'
END AS Discount
FROM orders;


17) 
SELECT FirstName, Salary,
CASE
  WHEN Salary >= 55000 THEN 'High'
  WHEN Salary BETWEEN 45000 AND 54999 THEN 'Medium'
  ELSE 'Low'
END AS SalaryLevel
FROM employees;


END OF PROJECT
